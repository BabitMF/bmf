/** \page RealTimeProc 实时处理

# 基于BMF的实时处理方案

### 方案简介

整个会议合流转推的流程会包含几个主要模块：

- 拉流管理模块：拉取多路参会人的音视频流以及Jit buffer相关处理，bytemeet团队使用Go实现
- 音频解码及混音模块：Opus解码和混音，BMF团队使用C++实现
- 视频解码模块：BMF内置模块
- 视频合流模块：把多路视频图像按照配置参数合并布局成单路图像输出给编码器，BMF团队使用python实现
- 编码模块：BMF内置模块，负责「音视频编码 + 封装 + 推流」

各个模块并行开发，再由BMF引擎进行不同语言模块的串联和执行，整体graph如下图所示

<img src="./meeting.png" style="zoom:50%;" />

### 动态Graph支持

实时场景的一个主要特点是Graph执行过程中需要能够**对Graph拓扑进行动态修改**，或者**下发一些动态的配置信息**。如对于会议场景，就需要对于会议中途加入/离开的用户进行处理，以及允许用户实时的调整合流的layout（直播场景的导播台也是类似场景）。针对这个需求，BMF设计和实现了非常通用的动态graph方案，能够在graph运行过程中，任意插入或者删除一个子Graph，或者下发一些信息动态的改变节点的行为。

举个例子：在会议过程中，会有新加入的用户以及离开会议的用户，每一个用户可以是被单独节点或者分支支撑着，通过在原有Graph中动态的增加或者删除这些节点就能很容易满足这样的实时处理的需求。如下图所示，初始阶段运行一个具有一路视频流的Graph作为一个开启的视频会议实例，第二阶段无缝衔接动态的加入了一位用户的视频流（模块6和7）到视频会议当中，第三阶段在不影响主会议实例的前提下用于共享屏幕的模块2和模块3被移出会议，同时上层应用动态的调整视频合流模块的模式和布局。

<img src="./dynamic_sample.png" style="zoom:40%;" />

### 业务支持与Demo

参考：

https://

https://
